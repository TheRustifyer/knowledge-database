
## ‚úÖ Step-by-step: Reset `admin` Password in Grocy (Docker Compose)

### üîπ 1. Create the migration file

Create a file named `9999.php` inside a folder called `migrations/`, next to your `docker-compose.yml`.

**Content of `migrations/9999.php`:**

```php
<?php
// File: migrations/9999.php
use Phinx\Migration\AbstractMigration;
use Grocy\Services\DatabaseService;
use Grocy\Services\UserService;

class ResetAdminPassword extends AbstractMigration
{
    public function up()
    {
        require_once __DIR__ . '/../helpers/ConsoleHelpers.php';
        require_once __DIR__ . '/../services/DatabaseService.php';
        require_once __DIR__ . '/../services/UserService.php';

        $db = new DatabaseService();
        $userService = new UserService();

        $username = 'admin';
        $newPassword = 'admin';

        $user = $db->Execute('SELECT id FROM users WHERE username = ?', [$username])->fetch();
        if ($user) {
            $userService->UpdateUser($user['id'], $username, $newPassword);
            echo "‚úÖ Password for user 'admin' reset to 'admin'\n";
        } else {
            echo "‚ö†Ô∏è User 'admin' not found!\n";
        }
    }

    public function down()
    {
        // Not needed
    }
}
```

### üîπ 2. Mount it in your Docker Compose file

Update your `docker-compose.yml`:

```yaml
services:
  grocy:
    image: linuxserver/grocy
    container_name: grocy
    volumes:
      - ./config:/config
      - ./migrations:/config/www/migrations  # <-- Add this
    ports:
      - 9283:80
    restart: unless-stopped
```

### üîπ 3. Restart the container

Run:

```bash
docker-compose -f .hosted/management/grocy/docker-compose.yaml down --remove-orphans && docker-compose -f .hosted/management/grocy/docker-compose.yaml up -d
```

### üîπ 4. Trigger the migration

1. Visit `http://<your-server>:9283/` or `https://grocy.home.lab`
2. Fill in the `username/password` form the `admin/admin` values

### üîπ 5. Clean up

After logging in and updating your password, **delete** the file:

```bash
rm migrations/9999.php
docker compose restart
```

>[!warning] Migrations doesn't run
>Last time I checked, migrations didn't run. So as last resource, just edit the `config.php` file under the `.../grocy/config/` dir
