
# Set MeshNet ON

```bash
‚îå‚îÄ> Ôåí  vv at Ó¨Å vv-minipc in @192.168.1.10 ~ via Óàµ v3.13.3 took 3s
‚ú¶ ‚ùØ nordvpn login --token e9f2ab13dd727d5ccc5930fc469e4884d391840706f2fcd5096aec6948685ae6
Welcome to NordVPN! You can now connect to VPN by using 'nordvpn connect'.

NOTE: By default, all users who are members of the 'nordvpn' group have permission to control the NordVPN application.
To limit access exclusively to the root user, remove all users from the 'nordvpn' group.
```

# Enable LAN Discovery

```bash
‚îå‚îÄ> Ôåí  vv at Ó¨Å vv-minipc in @192.168.1.10 ~ via Óàµ v3.13.3
‚ú¶ ‚ùØ nordvpn set lan-discovery on
LAN Discovery is set to 'enabled' successfully.
```

# ‚úÖ Step-by-Step Summary

| Task                      | Command/Action                                                                           |
| ------------------------- | ---------------------------------------------------------------------------------------- |
| Enable Meshnet on home Pi | `nordvpn set meshnet on`                                                                 |
| Allow your phone/VM       | `nordvpn meshnet peer local allow <peer>`<br>`nordvpn meshnet peer routing allow <peer>` |
| SSH into home             | `ssh user@my-home.nord`                                                                  |
| Expose HA Docker instance | Docker with `-p 8123:8123`                                                               |
| Access HA from remote     | `http://my-home.nord:8123`                                                               |

# üõ£Ô∏è What Does `meshnet peer routing allow` Do?

This command enables one Meshnet device to **route internet traffic from other peers through it**.

- Use it when you want, for example, your remote device (like your phone or laptop) to **exit to the internet** via your home network‚Äôs connection.
    
- Not required for simple internal access (SSH, Home Assistant).
    
- Needed only if you're using your home server as a **VPN gateway** [Pi-hole Userspace+15meshnet.nordvpn.com+15NordVPN Support+15](https://meshnet.nordvpn.com/how-to/traffic-routing/set-up-your-own-vpn-server?utm_source=chatgpt.com)[meshnet.nordvpn.com](https://meshnet.nordvpn.com/features/renaming-devices?utm_source=chatgpt.com).

Ex:

```bash
‚îå‚îÄ> Ôåí  vv at Ó¨Å vv-minipc in @192.168.1.10 ~ via Óàµ v3.13.3
‚ú¶ ‚ùØ nordvpn meshnet peer routing allow lineageOS

Traffic routing for 'alex.vergara-himalayas.nord' has been allowed.
```

# Split tunneling

## Windows

To restore full access to `192.168.1.10` (SSH, AdGuard DNS, Home Assistant) while NordVPN is active on Windows, you need two key configurations:

---

## ‚úÖ 1. Use NordVPN Split-Tunneling

**Allow core apps to bypass the VPN**, sending their traffic directly through your LAN. Here's how:

1. Open NordVPN desktop app (Windows 10/11).
2. Click **Settings** (gear icon) ‚Üí **Split Tunneling**.
3. Turn **Enable Split Tunneling** ON.
4. Add these two apps to the **Bypass VPN** list:
    - Your SSH client (e.g., `plink.exe`, `ssh.exe`, or Óóº PuTTY)
    - Your web browser (e.g., Chrome, Edge) if using `http://hass.home.lab`

This ensures SSH and browser traffic to your LAN go direct, while the rest stays in the VPN

---

## üì° 2. Add a Static LAN Route

Split tunneling may not suffice; you need a specific route for `192.168.1.10`:

Open **PowerShell as Administrator** and run:

```powershell
route add 192.168.1.10 mask 255.255.255.255 192.168.50.1 metric 1
```

> [!info] 
Replace `192.168.50.1` with your actual Wi‚ÄëFi/router gateway.  
This forces all traffic to `192.168.1.10` through your LAN rather than the VPN tunnel [niksec.com+1NordVPN Support+1](https://niksec.com/split-tunneling-on-windows-10-or-11-using-the-native-vpn-client/?utm_source=chatgpt.com).

>[!caution] To persist after reboot, add the `-p` flag


## üîÑ 3. Combine with DNS Whitelisting

For DNS to resolve `*.home.lab` locally, ensure:

```powershell
nordvpn-service.exe whitelist add subnet 192.168.50.0/24
nordvpn-service.exe whitelist add port 53
```

This keeps DNS queries to AdGuard Home bypassing the **VPN**. While split tunneling covers traffic, whitelisting ensures DNS also follows your **LAN**.

## üß© Summary of Setup

|Component|Configuration|
|---|---|
|SSH/browser traffic|**Split-tunneling** bypass|
|LAN route to AdGuard|`route add 192.168.1.10 ‚Ä¶`|
|DNS queries|Whitelist port 53 & subnet|
## üõ† Quick Tests

1. Run `ping 192.168.1.10` ‚Äî it should reply.
2. `ssh vv@192.168.1.10` should connect.
3. Clear DNS cache: `ipconfig /flushdns`
4. Browse `http://hass.home.lab:8123` ‚Äî should resolve and connect.

---

## ‚úÖ Next Steps/Automation

- Use split tunneling instead of broad whitelists.
    
- Make `route -p add ...` persistent at boot.
    
- If SSH tools change location, update split-tunneling accordingly.

>[!NOTE]
>A legacy approach (just for consideration) [can be found here](https://www.aazuspan.dev/blog/til-whitelisting-a-local-subnet-with-nordvpn/)
